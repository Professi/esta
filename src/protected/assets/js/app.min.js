!function(e){e(document).ready(function(){function t(){e("#lockAt_value").val(e('input[id$="_lockAt"]')[0].value+" "+e('input[id$="_lockAt"]')[1].value)}function n(e,t){this.group=e,this.user=t}function i(t){var n=e(this).parents("tr"),i=n.find(".group-user").val(),a=n.find(".group-id").val(),l=t.data.param1,c=-1;e.each(o,function(e){this.group===a&&this.user===i&&(c=e)}),o.splice(c,1),n.remove(),l.select2("open")?l.select2("close"):(l.select2("close"),l.select2("open"))}if(e(document).foundation(),e("#LoginForm_email").focus(),e(".js_show").toggle(),e(".js_hide").toggle(),e("#language-selector").parent().clone().appendTo(e(".top-bar .left")),e(document).keyup(function(t){27===t.keyCode&&e(".ul-nav-toggle").click()}),e(".sticky").append(e("<i/>",{"class":"fi-zoom-out ul-nav-toggle"})),e(".ul-nav li").click(function(){0===e(this).find("#language-selector").length&&(window.location=e(this).find("a").attr("href"))}),e(".ul-nav-toggle").click(function(){var t=e(this);t.toggleClass("fi-zoom-out fi-zoom-in"),t.siblings("ul").toggleClass("ul-nav ul-nav-hide")}),e("#teacher-ac").on("autocompleteselect",function(e,t){e.preventDefault(),window.location.href="index.php?r=Appointment/makeAppointment&teacher="+t.item.value}),e("#teacher-ac").on("autocompletefocus",function(e){e.preventDefault()}),e(".avaiable").css("cursor","pointer"),e(".appointment-create-table .avaiable").click(function(){var t=e(this);e("#form_date").val(t.parents("table").data("date")),e("#form_time").val(t.siblings().text().trim()),e('select[name*="dateAndTime_id"]').select2("val",t.data("id"))}),e(".delete-children").click(function(){return confirm("Wenn Sie dieses Kind löschen werden auch alle Termine des Kindes gelöscht.")?void 0:!1}),e(".delete-appointment").click(function(){return confirm("Termin wirklich löschen?")?void 0:!1}),e(".infolabel").each(function(){e(this).append(e("<i/>",{"class":"fi-info"}))}),e(".infofeld").on({mouseenter:function(){e(".infobox").show(),e(".infobox").children("p").html(e(this).siblings(".infotext").html()),e(".infobox").css("left",e(document).width()/2-200),e(".infobox").css("top",e(window).height()/4)},mouseleave:function(){var t=e(event.toElement),n=e(".infobox").get(0);n===t.get(0)||e.contains(n,t)?e(n).one("mouseleave",function(){e(n).fadeOut("fast")}):e(n).fadeOut("fast")}}),e("#CsvUpload_file").on("change",function(){this.files[0].size>maxFileSize?(alert(errorMessage),e(this).val("")):e("#file-input-name").val(this.files[0].name)}),""!==e("#lockAt_value").val()&&"string"==typeof e("#lockAt_value").val()){var a=e("#lockAt_value").val(),l=a.split(" ");e("#date_lockAt").val(l[0]),e("#time_lockAt").val(l[1])}e("#User_role").on("change",function(t){t.val>1?e("#groups-select").select2("enable",!0):(e("#groups-select").select2("enable",!1),e("#groups-select").select2("val",""))}),e('select[id$="_allowBlockingAppointments"], select[id$="_banUsers"], select[id$="_mailsActivated"]').on("change",function(t){var n="0"===t.target.value?!0:!1;e(t.target).parents("fieldset").children(".row:gt(0)").children(".small-4").children("input, select").attr("disabled",n)}),e('select[id$="_randomTeacherPassword"]').on("change",function(t){var n="0"===t.target.value?!1:!0;e('input[id$="_defaultTeacherPassword"]').attr("disabled",n)}),e('input[id$="_dateFormat"], input[id$="_timeFormat"]').on("change",function(){e("#ConfigForm_dateTimeFormat").val(e('input[id$="_dateFormat"]').val()+" "+e('input[id$="_timeFormat"]').val())}),e('input[id$="_lockAt"]').on({change:function(){t()},keyup:function(){t()}}),e('input[id$="_display"]').on("autocompletefocus",function(e){e.preventDefault()}),e('input[id$="_teacher"]').on("autocompletefocus",function(e){e.preventDefault()}),e("#appointment_parent").on("autocompletefocus",function(e){e.preventDefault()}),e('input[id$="_display"]').on("autocompleteselect",function(t,n){t.preventDefault(),e(this).val(n.item.label),e(this).nextAll("input").val(n.item.value)}),e("#appointment_teacher").on("autocompleteselect",function(t,n){t.preventDefault(),e(this).val(n.item.label),e(this).nextAll("input").val(n.item.value),e.get("index.php/?r=appointment/getteacherappointmentsajax",{teacherId:n.item.value,classname:"Appointment"},function(t){e("#appointment_dateAndTime_select").html(t),e("#appointment_dateAndTime_select").children("select").select2()},"json")}),e("#appointmentBlock_teacher").on("autocompleteselect",function(t,n){t.preventDefault(),e(this).val(n.item.label),e(this).nextAll("input").val(n.item.value),e.get("index.php/?r=appointment/getteacherappointmentsajax",{teacherId:n.item.value,classname:"BlockedAppointment"},function(t){e("#appointment_dateAndTime_select").html(t),e("#appointment_dateAndTime_select").children("select").select2()},"json")}),e("#appointment_parent").on("autocompleteselect",function(t,n){t.preventDefault(),e(this).val(n.item.label),e.get("index.php/?r=appointment/getselectchildrenajax",{id:n.item.value},function(t){e("#appointment_parent_select").html(t),e("#appointment_parent_select").children("select").select2()},"json")}),e("#print-view-teacher").on("autocompleteselect",function(t,n){t.preventDefault(),e(this).val(n.item.label),e(this).data("id",n.item.value)}),e("#print-view-button").click(function(){var t=e("#print-view-date").val(),n=e("#print-view-teacher").data("id");""!==t&&"string"==typeof t&&""!==n&&"string"==typeof n&&(window.location.href="index.php?r=appointment/overview&id="+n+"&date="+t)});var o=[],c=0;e.each(e("#date-form table #input-target").children(),function(){var t=e(this).find(".group-user").val(),i=e(this).find(".group-id").val(),a=new n(i,t);o.push(a),c++}),e("#group-users").on("select2-selecting",function(t){var a=e("#groups"),l=a.val(),s=new n(l,t.val),r=!1;if(e.each(o,function(){this.group===s.group&&this.user===s.user&&(r=!0)}),!r){var p=e(this),u=e("<td/>").text(e(this).find("option[value="+t.val+"]").text()),d=e("<td/>").text(a.select2("data").text),f=e("#input-template"),m=f.find(".group-user").clone().attr("name","user["+c+"]").val(s.user),h=f.find(".group-id").clone().attr("name","group["+c+"]").val(s.group),v=f.find(".group-delete").clone().attr("name","group["+c+"]"),g=f.find("i").clone().click({param1:p},i);u.append(m),d.append(h).append(v),e("<tr/>").append(u).append(d).append(e("<td/>",{"class":"text-center"}).append(g)).appendTo(e("#input-target")),o.push(s),c++}event.preventDefault(),t.preventDefault(),p.select2("close"),p.select2("open")}),e("#close-user-select").on("click",function(){e("#group-users").select2("close")}),e(".flag-relation-for-delete").click(function(){var t=e(this).parents("tr");t.find(".group-delete").click(),t.toggleClass("delete-assign")})});var t=0;e(".add-child-tan").click(function(){t++;var n=e(".customChild:first").clone();e(n).children().each(function(){var n=e(this).find("input"),i=!1;n.hasClass("select2-focusser")&&(n=e(this).find("select"),i=!0),0!==n.length&&(e(n).attr("name",e(n).attr("name").replace(/\d/,t)),e(n).attr("id",e(n).attr("id").replace(/\d/,t)),e(n).val("")),i&&(e(n).attr("tabindex",""),e(n).attr("class",""),e(this).children(".small-9").html(n))}),e(".customChild:last").after(e(n)),e(n).find("select").select2()})}(jQuery);