!function(e){e(document).ready(function(){function t(){e("#lockAt_value").val(e('input[id$="_lockAt"]')[0].value+" "+e('input[id$="_lockAt"]')[1].value)}function a(e,t){this.group=e,this.user=t}function n(t){var a=e(this).parents("tr"),n=a.find(".group-user").val(),i=a.find(".group-id").val(),l=t.data.param1,o=-1;e.each(p,function(e){this.group===i&&this.user===n&&(o=e)}),p.splice(o,1),a.remove(),l.select2("open")?l.select2("close"):(l.select2("close"),l.select2("open"))}e(document).foundation(),e("#LoginForm_email").focus(),e(".js_show").toggle(),e(".js_hide").toggle(),e("#language-selector").parent().clone().appendTo(e(".top-bar .left")),e(document).keyup(function(t){27===t.keyCode&&e(".ul-nav-toggle").click()});var i=function(t,a,n){var i=!0,l=a.find("div.button"),o=a.find("input");return e.each(t,function(e,t){"undefined"==typeof t&&(alert(e),i=!1)}),i?(l.removeClass("success alert secondary").addClass("secondary").find("i").attr("class","fi-upload-cloud"),o.val(""),void e.ajax({url:"index.php",method:"GET",data:t}).done(function(t){try{answer=JSON.parse(t)}catch(a){l.removeClass("secondary").addClass("alert").find("i").attr("class","fi-alert"),o.val(a)}console.log(answer),answer.status?(l.removeClass("secondary").addClass("success").find("i").attr("class","fi-check"),e.each(n,function(e,t){t.val(""),t.data("id","")})):l.removeClass("secondary").addClass("alert").find("i").attr("class","fi-alert"),o.val(answer.msg)}).fail(function(e,t){l.removeClass("secondary").addClass("alert").find("i").attr("class","fi-alert"),o.val(t)})):void alert(msg_ajax_param_empty)};if(e(".sticky").append(e("<i/>",{"class":"fi-eye ul-nav-toggle",text:" Menu"})),e(".ul-nav li").click(function(){0===e(this).find("#language-selector").length&&(window.location=e(this).find("a").attr("href"))}),e(".ul-nav-toggle").click(function(){var t=e(this);t.siblings("ul").toggleClass("ul-nav ul-nav-hide")}).click(),e("#teacher-ac").on("autocompleteselect",function(e,t){e.preventDefault(),window.location.href="index.php?r=Appointment/makeAppointment&teacher="+t.item.value}),e(".avaiable").css("cursor","pointer"),e(".appointment-create-table .avaiable").click(function(){var t=e(this);e("#form_date").val(t.parents("table").data("date")),e("#form_time").val(t.siblings().text().trim()),e('select[name*="dateAndTime_id"]').select2("val",t.data("id"))}),e(".delete-children").click(function(){return confirm(msg_delete_children)?void 0:!1}),e(".delete-appointment").click(function(){return confirm(msg_delete_appointment)?void 0:!1}),e(".infolabel").each(function(){e(this).append(e("<i/>",{"class":"fi-info"}))}),e(".infofeld").click(function(t){t.preventDefault(),e(".infobox").show(),e(".infobox").children("p").html(e(this).siblings(".infotext").html()),e(".infobox").css("left",e(document).width()/2-200),e(".infobox").css("top",e(window).height()/4),t.stopPropagation(),e(document).one("click",function(){e(".infobox").hide()})}),e("#CsvUpload_file").on("change",function(){this.files[0].size>maxFileSize?(alert(errorMessage),e(this).val("")):e("#file-input-name").val(this.files[0].name)}),""!==e("#lockAt_value").val()&&"string"==typeof e("#lockAt_value").val()){var l=e("#lockAt_value").val(),o=l.split(" ");e("#date_lockAt").val(o[0]),e("#time_lockAt").val(o[1])}if(e("#User_role").on("change",function(t){t.val>1?e("#groups-select").select2("enable",!0):(e("#groups-select").select2("enable",!1),e("#groups-select").select2("val",""))}),e('select[id$="_allowBlockingAppointments"], select[id$="_banUsers"], select[id$="_mailsActivated"]').on("change",function(t){var a="0"===t.target.value?!0:!1;e(t.target).parents("fieldset").children(".row:gt(0)").children(".small-4").children("input, select").attr("disabled",a)}),e('select[id$="_randomTeacherPassword"]').on("change",function(t){var a="0"===t.target.value?!1:!0;e('input[id$="_defaultTeacherPassword"]').attr("disabled",a)}),e('input[id$="_dateFormat"], input[id$="_timeFormat"]').on("change",function(){e("#ConfigForm_dateTimeFormat").val(e('input[id$="_dateFormat"]').val()+" "+e('input[id$="_timeFormat"]').val())}),e('input[id$="_lockAt"]').on({change:function(){t()},keyup:function(){t()}}),e('#teacher-ac,input[id$="_display"],input[id$="_teacher"],#appointment_parent,#print-view-teacher,#room-assign-teacher,#room-assign-room').on("autocompletefocus",function(e){e.preventDefault()}),e('input[id$="_display"]').on("autocompleteselect",function(t,a){t.preventDefault(),e(this).val(a.item.label),e(this).nextAll("input").val(a.item.value)}),e("#appointment_teacher").on("autocompleteselect",function(t,a){t.preventDefault(),e(this).val(a.item.label),e(this).nextAll("input").val(a.item.value),e.get("index.php/?r=appointment/getteacherappointmentsajax",{teacherId:a.item.value,classname:"Appointment"},function(t){e("#appointment_dateAndTime_select").html(t),e("#appointment_dateAndTime_select").children("select").select2()},"json")}),e("#appointmentBlock_teacher").on("autocompleteselect",function(t,a){t.preventDefault(),e(this).val(a.item.label),e(this).nextAll("input").val(a.item.value),e.get("index.php/?r=appointment/getteacherappointmentsajax",{teacherId:a.item.value,classname:"BlockedAppointment"},function(t){e("#appointment_dateAndTime_select").html(t),e("#appointment_dateAndTime_select").children("select").select2()},"json")}),e("#appointment_parent").on("autocompleteselect",function(t,a){t.preventDefault(),e(this).val(a.item.label),e.get("index.php/?r=appointment/getselectchildrenajax",{id:a.item.value},function(t){e("#appointment_parent_select").html(t),e("#appointment_parent_select").children("select").select2()},"json")}),e("#room-assign-room").on("autocompleteselect",function(t,a){t.preventDefault(),e(this).val(a.item.label),e(this).data("id",a.item.value)}),e("#print-view-teacher").on("autocompleteselect",function(t,a){t.preventDefault(),e(this).val(a.item.label),e(this).data("id",a.item.value)}),e("#print-view-button").click(function(){var t=e("#print-view-date").val(),a=e("#print-view-teacher").data("id");""!==t&&"string"==typeof t&&""!==a&&"string"==typeof a&&(window.location.href="index.php?r=appointment/overview&id="+a+"&date="+t)}),e("#print-view-all-button").click(function(){var t=e("#print-view-date").val(),a=e("#show-empty-plans").is(":checked")?1:0;""!==t&&"string"==typeof t&&(window.location.href="index.php?r=appointment/generatePlans&date="+t+"&emptyPlans="+a)}),e("#room-assign-teacher").on("autocompleteselect",function(t,a){t.preventDefault(),e(this).val(a.item.label),e(this).data("id",a.item.value)}),e("#room-assign-button-2").on("click",function(){var t=e("#room-assign-teacher"),a=t.data("id"),n=e("#room-assign-room"),l=n.val(),o=e("#room-assign-date").val(),s={r:"room/assignajaxteacher",teacher:a,room:l,date:o},r=e("#room-assign-status"),c=[t,n];i(s,r,c)}),e("#room-assign-button").on("click",function(){var t=e("#room-assign-teacher"),a=t.data("id"),n=e("#room-assign-room"),l=n.val(),o=e("#room-assign-date").val(),s={r:"room/assignajax",teacher:a,room:l,date:o},r=e("#room-assign-status"),c=[t,n];i(s,r,c)}),null!==document.getElementById("room-assignall-workspace")){var s=e("#room-assignall-template"),r=e("#room-assignall-workspace"),c=0,d=e("#room-assignall-date");e.each(teachers,function(e,t){var a=s.clone(),n=null!==t.title?t.title+" ":"",i=n+t.firstname+" "+t.lastname;c++,a.attr("id","room-assignall-element."+c),a.find("#room-assignall-teacher").attr("id","room-assignall-teacher."+c).data("id",t.id).val(i),a.find("#room-assignall-room").attr("id","room-assignall-room."+c),a.find("#room-assignall-status").attr("id","room-assignall-status."+c),r.prepend(a)}),e("#room-assignall-button").click(function(){confirm(msg_assignall_button+d.find("option:checked").text()+"?")&&r.find('div[id*="element."]').each(function(t,a){var n=e(a).find('input[id*="teacher."]'),l=n.data("id"),o=e(a).find('input[id*="room."]'),s=o.val(),r={r:"room/assignajax",teacher:l,room:s,date:d.val()},c=e(a).find('div[id*="status."]'),p=[];i(r,c,p)})}),e("#room-assignall-errors").click(function(){e("html, body").animate({scrollTop:e(".alert").first().offset().top+100},1e3)})}var p=[],u=0;e.each(e("#date-form table #input-target").children(),function(){var t=e(this).find(".group-user").val(),n=e(this).find(".group-id").val(),i=new a(n,t);p.push(i),u++}),e("#group-users").on("select2-selecting",function(t){var i=e("#groups"),l=i.val(),o=new a(l,t.val),s=!1;if(e.each(p,function(){this.group===o.group&&this.user===o.user&&(s=!0)}),!s){var r=e(this),c=e("<td/>").text(e(this).find("option[value="+t.val+"]").text()),d=e("<td/>").text(i.select2("data").text),m=e("#input-template"),f=m.find(".group-user").clone().attr("name","user["+u+"]").val(o.user),v=m.find(".group-id").clone().attr("name","group["+u+"]").val(o.group),h=m.find(".group-delete").clone().attr("name","group["+u+"]"),g=m.find("i").clone().click({param1:r},n);c.append(f),d.append(v).append(h),e("<tr/>").append(c).append(d).append(e("<td/>",{"class":"text-center"}).append(g)).appendTo(e("#input-target")),p.push(o),u++}event.preventDefault(),t.preventDefault(),r.select2("close"),r.select2("open")}),e("#close-user-select").on("click",function(){e("#group-users").select2("close")}),e(".flag-relation-for-delete").click(function(){var t=e(this).parents("tr");t.find(".group-delete").click(),t.toggleClass("delete-assign")})});var t=0;e(".add-child-tan").click(function(){t++;var a=e(".customChild:first").clone();e(a).children().each(function(){var a=e(this).find("input"),n=!1;a.hasClass("select2-focusser")&&(a=e(this).find("select"),n=!0),0!==a.length&&(e(a).attr("name",e(a).attr("name").replace(/\d/,t)),e(a).attr("id",e(a).attr("id").replace(/\d/,t)),e(a).attr("required",""),e(a).val("")),n&&(e(a).attr("tabindex",""),e(a).attr("class",""),e(this).children(".small-9").html(a))}),e(".customChild:last").after(e(a)),e(a).find("select").select2()})}(jQuery);